[0;32m[INFO][0m Starting GitHub Crawler Service Tests
Base URL: http://localhost:8080
GitHub Token: Set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

[1;33m[WARN][0m jq not found, JSON responses will not be formatted
[0;32m[INFO][0m Checking if crawler service is running...
[0;32m[INFO][0m âœ“ Service is running
==================================
[0;32m[INFO][0m Testing basic endpoints...
[0;32m[INFO][0m Testing GET /
[0;32m[INFO][0m âœ“ GET / returned 200
Response: {"service":"crawler","status":"running","version":"1.0.0"}

[0;32m[INFO][0m Testing GET /health
[0;32m[INFO][0m âœ“ GET /health returned 200
Response: {"status":"healthy","service":"crawler","timestamp":"2025-06-05T00:29:14.103641728+05:30","version":"1.0.0"}

[0;32m[INFO][0m Testing GET /metrics
[0;32m[INFO][0m âœ“ GET /metrics returned crawler metrics

==================================
[0;32m[INFO][0m Testing crawl endpoint...
[0;32m[INFO][0m Testing crawl with sattwyk/mailmon repository...
[0;32m[INFO][0m Testing POST /invoke
[0;32m[INFO][0m âœ“ POST /invoke returned 200
Response: {"total_files":66,"skipped_files":66,"processed_files":0,"errors":[{"file_path":"apps/web/eslint.config.mjs","error":"failed to get file content for apps/web/eslint.config.mjs: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"MIGRATION.md","error":"failed to get file content for MIGRATION.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/next.config.ts","error":"failed to get file content for apps/web/next.config.ts: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/agent/pyproject.toml","error":"failed to get file content for apps/agent/pyproject.toml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/public/next.svg","error":"failed to get file content for apps/web/public/next.svg: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/environments/dev/terraform.tfvars","error":"failed to get file content for infra/opentofu/environments/dev/terraform.tfvars: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/.gitignore","error":"failed to get file content for apps/web/.gitignore: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".vscode/settings.json","error":"failed to get file content for .vscode/settings.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/src/app/layout.tsx","error":"failed to get file content for apps/web/src/app/layout.tsx: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/tsconfig.json","error":"failed to get file content for apps/api/tsconfig.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"flake.nix","error":"failed to get file content for flake.nix: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".envrc","error":"failed to get file content for .envrc: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"docker-compose.yml","error":"failed to get file content for docker-compose.yml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/src/app/favicon.ico","error":"failed to get file content for apps/web/src/app/favicon.ico: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".gitignore","error":"failed to get file content for .gitignore: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".python-version","error":"failed to get file content for .python-version: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"flake.lock","error":"failed to get file content for flake.lock: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/wrangler.jsonc","error":"failed to get file content for apps/api/wrangler.jsonc: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".npmrc","error":"failed to get file content for .npmrc: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/public/vercel.svg","error":"failed to get file content for apps/web/public/vercel.svg: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/bots/telegram/pyproject.toml","error":"failed to get file content for apps/bots/telegram/pyproject.toml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/.gitignore","error":"failed to get file content for apps/api/.gitignore: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/agent/main.py","error":"failed to get file content for apps/agent/main.py: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/README.md","error":"failed to get file content for infra/opentofu/README.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/package.json","error":"failed to get file content for apps/api/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/bots/telegram/package.json","error":"failed to get file content for apps/bots/telegram/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/src/app/page.tsx","error":"failed to get file content for apps/web/src/app/page.tsx: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/bots/whatsapp/package.json","error":"failed to get file content for apps/bots/whatsapp/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"README.md","error":"failed to get file content for README.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/.terraform.lock.hcl","error":"failed to get file content for infra/opentofu/.terraform.lock.hcl: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".editorconfig","error":"failed to get file content for .editorconfig: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/tsconfig.json","error":"failed to get file content for apps/web/tsconfig.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/.gitignore","error":"failed to get file content for infra/opentofu/.gitignore: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/README.md","error":"failed to get file content for apps/web/README.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"biome.json","error":"failed to get file content for biome.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/environments/prod/terraform.tfvars","error":"failed to get file content for infra/opentofu/environments/prod/terraform.tfvars: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/postcss.config.mjs","error":"failed to get file content for apps/web/postcss.config.mjs: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/src/app/globals.css","error":"failed to get file content for apps/web/src/app/globals.css: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/agent/package.json","error":"failed to get file content for apps/agent/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".cursor/rules/important.mdc","error":"failed to get file content for .cursor/rules/important.mdc: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/bots/whatsapp/pyproject.toml","error":"failed to get file content for apps/bots/whatsapp/pyproject.toml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/package.json","error":"failed to get file content for apps/web/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/Makefile","error":"failed to get file content for infra/opentofu/Makefile: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/README.md","error":"failed to get file content for apps/api/README.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".husky/pre-commit","error":"failed to get file content for .husky/pre-commit: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/public/globe.svg","error":"failed to get file content for apps/web/public/globe.svg: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":".vscode/extensions.json","error":"failed to get file content for .vscode/extensions.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/api/src/index.ts","error":"failed to get file content for apps/api/src/index.ts: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/public/window.svg","error":"failed to get file content for apps/web/public/window.svg: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"apps/web/public/file.svg","error":"failed to get file content for apps/web/public/file.svg: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"packages/db/index.ts","error":"failed to get file content for packages/db/index.ts: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/main.tf","error":"failed to get file content for infra/opentofu/main.tf: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/outputs.tf","error":"failed to get file content for infra/opentofu/outputs.tf: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"package.json","error":"failed to get file content for package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/versions.tf","error":"failed to get file content for infra/opentofu/versions.tf: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"infra/opentofu/variables.tf","error":"failed to get file content for infra/opentofu/variables.tf: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"packages/db/drizzle.config.ts","error":"failed to get file content for packages/db/drizzle.config.ts: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"packages/db/package.json","error":"failed to get file content for packages/db/package.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"packages/db/schema.ts","error":"failed to get file content for packages/db/schema.ts: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"pyproject.toml","error":"failed to get file content for pyproject.toml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"packages/db/tsconfig.json","error":"failed to get file content for packages/db/tsconfig.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"pnpm-workspace.yaml","error":"failed to get file content for pnpm-workspace.yaml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"pnpm-lock.yaml","error":"failed to get file content for pnpm-lock.yaml: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"uv.lock","error":"failed to get file content for uv.lock: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"turbo.json","error":"failed to get file content for turbo.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"},{"file_path":"tooling/typescript/tsconfig.base.json","error":"failed to get file content for tooling/typescript/tsconfig.base.json: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"}],"root_tree_sha":"fd9292ab74db5a20a340752fff736d407e225835","duration":"1.915158163s","repo_info":{"owner":"sattwyk","name":"mailmon","ref":"main"}}

[0;32m[INFO][0m Testing crawl with path filter...
[0;32m[INFO][0m Testing POST /invoke
[0;32m[INFO][0m âœ“ POST /invoke returned 200
Response: {"total_files":1,"skipped_files":1,"processed_files":0,"errors":[{"file_path":"README.md","error":"failed to get file content for README.md: API error 404: {\"message\":\"Not Found\",\"documentation_url\":\"https://docs.github.com/rest/repos/contents#get-repository-content\",\"status\":\"404\"}","type":"fetch_error"}],"root_tree_sha":"fd9292ab74db5a20a340752fff736d407e225835","duration":"639.982702ms","repo_info":{"owner":"sattwyk","name":"mailmon","ref":"main"}}

==================================
[0;32m[INFO][0m Testing error cases...
[0;32m[INFO][0m Testing GET /invoke
[0;32m[INFO][0m âœ“ GET /invoke returned 405
Response: Method not allowed

[0;32m[INFO][0m Testing POST /invoke
[0;32m[INFO][0m âœ“ POST /invoke returned 400
Response: Invalid request body: invalid character 'j' looking for beginning of value

[0;32m[INFO][0m Testing POST /invoke
[0;32m[INFO][0m âœ“ POST /invoke returned 400
Response: repo_url is required

[0;32m[INFO][0m Testing POST /invoke
[0;32m[INFO][0m âœ“ POST /invoke returned 400
Response: Invalid repository URL: invalid repository URL format, expected owner/repo

==================================
[0;32m[INFO][0m Running basic performance test...
[0;32m[INFO][0m âœ“ 10 concurrent health checks completed in 0s

==================================
[0;32m[INFO][0m All tests completed successfully!
